# ============================================================================
# WAF Stack – Environment Variables
# Copy to .env and fill in values before starting the stack.
# ============================================================================

# ── Application mode ─────────────────────────────────────────────────────────
# "development" = lenient secret checks (warnings only)
# "production"  = strict checks – startup fails on weak/default secrets
APP_ENV=development

# ── Secrets (REQUIRED in production) ─────────────────────────────────────────
# Generate strong values:
#   openssl rand -hex 32
JWT_SECRET=<generate-with-openssl-rand-hex-32>
NGINX_CONTROL_TOKEN=<generate-with-openssl-rand-hex-32>
FORWARD_PROXY_CONTROL_TOKEN=<generate-with-openssl-rand-hex-32>
POSTGRES_PASSWORD=<generate-with-openssl-rand-hex-32>

# ── Admin seed ───────────────────────────────────────────────────────────────
# First-run only: password for the initial "admin" user created by migration.
# In production mode the seed is SKIPPED unless this is set.
# After first login change the password immediately.
ADMIN_INITIAL_PASSWORD=

# ── CORS Origins ─────────────────────────────────────────────────────────────
# JSON array of allowed origins. In production use your real domain(s).
# Example: ["https://waf.example.com"]
CORS_ORIGINS=["http://localhost","http://localhost:5173"]

# ── Database / Cache ─────────────────────────────────────────────────────────
# Normally set by docker-compose; override only if running outside compose.
# DATABASE_URL=postgresql+asyncpg://waf:<password>@postgres:5432/waf
# REDIS_URL=redis://redis:6379
# MONGODB_URL=mongodb://mongodb:27017/waf_logs

# ── VirusTotal (optional) ───────────────────────────────────────────────────
VIRUSTOTAL_API_KEY=

# ── Forward proxy binding ───────────────────────────────────────────────────
# Default: localhost only. Set 0.0.0.0 to expose (behind firewall).
FORWARD_PROXY_BIND_IP=127.0.0.1
FORWARD_PROXY_PORT=3128

# ── Admin panel IP ACL ──────────────────────────────────────────────────────
# Comma-separated CIDRs allowed to reach /admin-ui/ and /admin-api/.
# Empty = localhost only in dev, deny-all in production.
ADMIN_ALLOWED_CIDRS=

# ── Helper cooldowns ────────────────────────────────────────────────────────
NGINX_CONTROL_COOLDOWN_SECONDS=1
FORWARD_PROXY_CONTROL_COOLDOWN_SECONDS=1

# ── Debug/Dev ────────────────────────────────────────────────────────────────
DEBUG=false
PORT=8001
